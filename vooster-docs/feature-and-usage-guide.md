# AdMate Vision — 기능 설명 및 사용 방법

옥외 광고 게재 현황 자동 보고 툴의 **기능**과 **사용 방법**을 블릿 형태로 정리한 문서입니다.

---

## 1. 프로젝트 개요

- **제품명**: AdMate Vision (옥외 광고 게재 현황 자동 보고 툴)
- **목적**: 옥외 광고 운영 담당자의 광고 게재 현황 보고 업무 자동화
- **대상 사용자**: 옥외 광고 운영 담당자
- **주요 가치**:
  - 촬영 → 광고주·위치 인식 → 보고 발송까지 한 흐름으로 처리
  - 보고 업무 시간 단축 및 정확·신속한 보고
  - GPS·OCR·공공데이터 기반 자동화

---

## 2. 기능 설명 (블릿)

### 2.1 회원·인증

- **회원가입**
  - 이름·이메일만 입력하여 가입
  - 가입 후 바로 촬영·보고 기능 사용 가능
- **로그인 / 로그아웃**
  - 로그인 시 촬영·광고주·보고 이력 등 보호 구간 접근
  - 로그아웃 시 공개 페이지만 이용
- **자동 로그인 유도**
  - 이미 등록된 이메일(쿠키)이 있으면 로그인 상태로 캡처 화면으로 이동

---

### 2.2 광고 촬영 (캡처)

- **스마트폰 카메라 촬영**
  - 브라우저에서 카메라 권한 허용 후 실시간 미리보기
  - 단일 촬영 또는 **다중 촬영**(여러 장 연속 촬영) 지원
- **촬영 모드**
  - **위치 기반**: 지하철 역·호선 인식 시 역명·호선 자동 추출 후 파일명·보고에 반영
  - **위치 없음**: 역/호선 없이 광고주·사용자직접기입명·날짜만으로 파일명 생성
- **이미지 처리**
  - 촬영본 회전(90° 좌/우), 이미지 압축 후 전송
  - OCR·광고주 매칭용으로 서버 또는 클라이언트(Tesseract) 사용

---

### 2.3 OCR (문자 인식)

- **서버 OCR (Google Cloud Vision)**
  - `GOOGLE_CLOUD_VISION_API_KEY` 설정 시 서버에서 텍스트 추출
  - **역명 추출 전용**: 바운딩 박스가 큰 텍스트(역명판) 우선 사용
  - 광고주 매칭에는 전체 OCR 텍스트 사용(역명용 큰 글자만 쓰지 않음)
- **클라이언트 OCR (Tesseract)**
  - API 키 미설정 시 브라우저에서 Tesseract.js로 폴백
- **역명·호선 추출**
  - 역명판에서 **역번호(3자리)**·**한글 역명** 추출
  - **1·2·5·7·8호선**만 사용, 역명→호선 자동 매칭(예: 여의도 → 5호선)
  - 역명이 띄어쓰기로 분리되어 인식되면(예: 군 자) 블록을 합쳐 역명 후보 생성(군자)
  - 별칭 지원(예: 능동 → 군자역, 5호선)

---

### 2.4 광고주 인식

- **자동 매칭**
  - OCR 텍스트와 DB의 광고주명·검색어를 비교하여 매칭
  - 유사도·정확 일치 길이 등으로 신뢰도 판단
- **광고주 관리**
  - **광고주 목록**: 등록된 광고주 조회
  - **광고주 등록**: 이름·이메일·캠페인 담당자(이름·이메일)·검색어 등 입력
  - **광고주 수정·삭제**: 상세/편집 화면에서 수정, 삭제 시 확인
  - **일괄 등록**: 여러 광고주를 한 번에 등록
- **인식 결과 표시**
  - 촬영 확인 화면에서 「인식 광고주: ○○○」 표시
  - 미인식 시 보고 발송 불가, 다운로드·파일명에는 「광고주 미인식」 등 반영

---

### 2.5 위치 정보

- **GPS 기반 주소**
  - 촬영 시 위도·경도 수집 후 역지오코딩으로 주소 라벨 표시(선택)
- **지하철 역·호선**
  - 역명판 OCR로 **역명**·**호선** 추출
  - 1·2·5·7·8호선만 사용, 역명 화이트리스트로 검증
  - 역번호만 인식돼도 해당 호선이 1·2·5·7·8이면 호선만 표시 가능(역명 미인식 시)

---

### 2.6 저장 파일명

- **위치 기반 촬영**
  - 형식: `{광고주}_{호선}_{역명}_{사용자직접기입명}_{YYYYMMDD}_{순번}.jpg`
  - 예: `서울여자대학교_5호선_군자_DI13_20260203_01.jpg`
- **위치 없음 촬영**
  - 형식: `{광고주}_{사용자직접기입명}_{YYYYMMDD}_{순번}.jpg`
- **파일명 편집**
  - 확인 페이지에서 **저장 파일명** 목록을 직접 수정 가능
  - **일괄 수정**: 찾을 문자열 / 바꿀 문자열 입력 후 「선택 항목에 적용」 또는 「전체 적용」
  - 예: "5호선" → "8호선" 일괄 치환

---

### 2.7 다운로드

- **ZIP 다운로드**
  - 촬영 확인 페이지에서 **ZIP 다운로드** 클릭
  - 편집된 파일명으로 촬영본이 ZIP에 담겨 다운로드
  - 서버 저장 없이 브라우저에서 ZIP 생성 후 다운로드

---

### 2.8 보고 발송 (이메일)

- **발송 조건**
  - **광고주가 인식된** 촬영만 보고 발송 가능
  - 수신자: 광고주 이메일 또는 캠페인 담당자 이메일 중 선택
- **발송 내용**
  - 촬영 이미지 ZIP 첨부
  - (선택) **PPT 노출량 보고서** 첨부
- **PPT 노출량 보고서**
  - **표시 조건**: 역·호선이 인식되고, 광고주가 매칭되었을 때만 옵션 노출
  - **포함 시**: 공공데이터(역별 승하차/유동인구) 기반 예상 노출량·시간대별 표·차트가 포함된 PPT 생성 후 이메일 첨부
  - **게재 기간**: 기본 7일, 입력 필드에서 변경 가능
  - **촬영 사진**: ZIP에 들어 있는 촬영 이미지를 PPT 슬라이드에 포함(슬라이드당 2장 배치)
  - **템플릿**: 표지·노출량 요약·촬영 광고 사진·문서 끝 등 슬라이드별 템플릿 이미지 사용(설정 시)
- **보고 이력**
  - 발송 시 DB에 저장(광고주·역·호선·이미지 수·발송 시각 등)
  - **보고 이력** 페이지에서 과거 발송 목록 조회

---

### 2.9 노출량·공공데이터

- **데이터 출처**
  - 공공데이터포털 **서울교통공사_역별승하차인원** 등 API 연동(환경 변수 설정 시)
  - 역·호선·게재 기간에 맞춰 일평균 유동인구·시간대별 노출량 추정
- **PPT 반영**
  - 노출량 요약 슬라이드: 역/호선, 일평균 유동인구, 게재 기간, 예상 총 노출량
  - 시간대별 표·막대 그래프·도넛 차트(데이터 있을 때)
  - 주의 문구: 공공데이터 기반 추정치이며 실제 노출과 차이 있을 수 있음

---

### 2.10 기타 기능

- **히어로 영상(랜딩)**
  - 메인 페이지 히어로 구간에 동영상 재생(음소거 자동재생)
  - **소리 켜기/끄기** 버튼으로 사용자가 소리 온/오프 선택
- **대시보드**
  - 로그인 후 진입 가능한 대시보드에서 주요 기능으로 이동
- **보고 이력**
  - 과거 보고 발송 이력 목록 확인

---

## 3. 사용 방법 (블릿)

### 3.1 처음 사용할 때

- **회원가입**
  - 랜딩 페이지에서 **Sign Up** → 이름·이메일 입력 후 가입
- **로그인**
  - **Sign In** → 가입한 이메일로 로그인( Supabase Auth 사용 시 해당 방식 적용)
- **배포 URL**
  - Vercel 등으로 배포된 HTTPS URL에서 접속(스마트폰 카메라 사용 시 HTTPS 필요)

---

### 3.2 광고 촬영부터 보고까지

1. **촬영**
   - 로그인 후 **촬영(캡처)** 메뉴 진입
   - 카메라 권한 허용 → 단일 또는 다중 촬영
   - 위치 기반이면 역명판이 나오도록 촬영 시 역·호선 자동 인식에 유리
2. **확인**
   - 촬영 직후 또는 목록에서 **확인** 화면으로 이동
   - 인식된 광고주·역명·호선·파일명 확인
   - 필요 시 **사용자직접기입명** 입력, **저장 파일명** 일괄 수정
3. **다운로드**
   - **ZIP 다운로드**로 촬영본을 편집된 파일명으로 저장
4. **보고 발송**(광고주 인식된 경우)
   - **보고 발송** 설정: 수신자(광고주/캠페인 담당자), (선택) PPT 포함, 게재 기간
   - **발송** 클릭 → 이메일 발송 및 보고 이력 저장

---

### 3.3 광고주 관리

- **등록**: 광고주 메뉴 → **새 광고주** → 이름·이메일·캠페인 담당자·검색어 등 입력 후 저장
- **수정**: 광고주 목록에서 해당 행 선택 → **편집** → 수정 후 저장
- **일괄 등록**: **일괄 등록** 화면에서 여러 건 한 번에 입력 후 등록

---

### 3.4 보고 이력 보기

- **보고** 메뉴에서 과거 발송 목록 확인
- 광고주·역·호선·이미지 수·발송 시각 등 표시

---

### 3.5 환경 설정(관리자·배포 시)

- **Supabase**: 회원·광고주·보고 이력 저장용 URL·anon key·service role key
- **Google Cloud Vision**: 서버 OCR 사용 시 API 키
- **Resend**: 보고 이메일 발송용 API 키·발신 주소(도메인 인증 필요)
- **공공데이터포털**: 노출량·PPT용 API 키·(선택) 역별승하차 API 엔드포인트
- 상세: `vooster-docs/vercel-deploy.md`, `vooster-docs/resend-vercel-setup.md`, `vooster-docs/public-data-api-guide.md`, `.env.example` 참고

---

## 4. 제한 사항·참고

- **호선**: 1·2·5·7·8호선만 역명·호선 매칭 및 노출량/PPT에 사용
- **보고 발송**: 광고주가 인식된 촬영만 가능
- **PPT**: 역·호선 인식 + 광고주 매칭 시에만 「PPT 노출량 보고서 포함」 옵션 표시
- **이메일**: Resend 도메인 인증 시 본인 도메인 발신 가능, `vercel.app` 도메인으로는 인증 불가
- **OCR**: API 키 없으면 클라이언트 Tesseract 사용(정확도·속도는 환경에 따라 다름)

---

## 5. 관련 문서

- **접목 기술·역할·유료 비용(월 1,000건 기준)**: `vooster-docs/tech-stack-and-costs.md`
- **배포**: `vooster-docs/vercel-deploy.md`
- **이메일(Resend)**: `vooster-docs/resend-vercel-setup.md`
- **공공데이터·노출량**: `vooster-docs/public-data-api-guide.md`
- **PPT 템플릿**: `vooster-docs/report-ppt-slide-templates.md`
- **파일명·저장**: `vooster-docs/capture-save-and-filename-edit.md`
- **환경 변수 예시**: `.env.example`
