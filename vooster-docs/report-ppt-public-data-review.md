# 보고서 PPT·공공데이터 기반 노출량 분석 검토

## 1. 궁극 목표 (요청 사항)

- **별도 보고서 형태(PPT)** 로 제작 후 메일 첨부
- 공공포털 데이터를 기반으로:
  - **광고 게재 기간** (세분화: 요일·시간대)
  - **유동인구 데이터** 기반 **예상 노출량** 분석·제공
  - 촬영 **이미지 + 위 분석**을 담은 **최종 PPT** 생성

---

## 2. 공공 데이터 출처 (한국 지하철 이용자 수)

| 출처 | 제공 내용 | 비고 |
|------|-----------|------|
| **서울 열린데이터광장** | 서울 지하철(1~9호선·공항철도 등) **역별·시간대별** 승하차 인원, 매월 갱신, 교통카드 기반 | 시간대별 분석에 적합 |
| **공공데이터포털 (data.go.kr)** | 서울교통공사·한국철도공사 등 **역별 승하차 현황**, **시간대별 승하차 인원** | API·CSV/XLSX 다운로드 |
| **철도통계포털 (KRIC)** | 국토교통부·한국철도공단, **도시철도 여객수송** 연도별·월별 | 집계 단위가 큼 |

**데이터 접근**: CSV/XLSX 다운로드, Open API 실시간 조회 가능.

---

## 3. 검토 포인트

### 3.1 데이터 정합성

- **역·호선·요일·시간대** 단위로 매칭 가능한지 확인 필요.
- 촬영 시 저장하는 **역명·호선**과 공공 데이터의 **역/노선 코드·명칭** 매핑 테이블이 필요할 수 있음 (예: "올림픽공원" ↔ 데이터 내 역 ID/이름).

### 3.2 예상 노출량 정의

- **노출량** = 해당 역·시간대 **유동인구(승하차)** × **게재 기간(일수)** × (선택) 가중치.
- 공공 데이터가 **일평균** 또는 **시간대별**이면, “게재 기간(요일·시간대)”에 맞춰 집계 로직 설계 필요.

### 3.3 PPT 생성 방식

| 방식 | 장점 | 단점 |
|------|------|------|
| **서버에서 PPT 생성 (라이브러리)** | 자동화, 템플릿 일관성 | pptx-gen 등 라이브러리 도입, 레이아웃/한글 폰트 처리 |
| **HTML/이미지 → PDF → PPT** | 구현 단순 | 디자인 제한, 표/차트 표현이 번거로울 수 있음 |
| **외부 서비스/스프레드시트 연동** | 고품질 레이아웃 | 비용·의존성, 연동 개발 필요 |

**권장**: 1차는 **pptx-gen (Node)** 등으로 **고정 템플릿** 기반 PPT 생성(표·차트·촬영 이미지 삽입), 2차에서 디자인·레이아웃 확장.

### 3.4 구현 단계 제안

1. **Phase 1 (현재)**  
   - ZIP 첨부 보고 메일 발송 (구현 완료)  
   - Resend + 제목/본문/수신자 규칙 적용  

2. **Phase 2 (데이터 연동)**  
   - 공공 API 또는 CSV/XLSX 파싱  
   - 역·호선·요일·시간대별 유동인구(승하차) 조회·캐시  
   - 촬영 메타(역명, 호선, 촬영일/시간)와 매핑  

3. **Phase 3 (노출량·보고서)**  
   - 게재 기간(요일·시간대) 산정 로직  
   - 예상 노출량 계산 (유동인구 × 기간 등)  
   - 텍스트/표/차트 포함 보고서 데이터 구조 정의  

4. **Phase 4 (PPT 생성·첨부)**  
   - pptx-gen 등으로 슬라이드 생성 (표지, 촬영 이미지, 노출량 표/차트, 안내 문구)  
   - 생성된 PPT를 메일 첨부 (ZIP + PPT 둘 다 또는 PPT만 선택 가능하도록 확장)

---

## 4. 정리

- **공공 데이터**: 서울 열린데이터광장·공공데이터포털의 **역별·시간대별** 데이터가 요일/시간대 세분화와 노출량 추정에 적합.
- **PPT 보고서**: 별도 확장 논의로 두고, 우선 **ZIP 첨부 메일**을 운영한 뒤, **역/호선 매핑 → 유동인구 조회 → 노출량 계산 → PPT 자동 생성** 순으로 단계 도입하는 구도로 검토 가능.
