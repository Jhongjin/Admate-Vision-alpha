# 역명 미인식·호선만 추출되는 현상 분석 및 개선

## 현상

- **역명**: 미인식
- **호선**: 5호선 정상 추출
- **예시**: 역명판 "544 군자 (능동)" 촬영 시

## 원인

1. **호선이 나오는 이유**  
   역번호 **544**는 OCR에서 잘 추출되고, `lineFromStationNumber(544)` → **5호선**으로 계산됩니다.  
   역명이 화이트리스트에 없어도, **역번호만 있으면** 1·2·5·7·8호선일 때 호선은 그대로 표시되도록 되어 있습니다.

2. **역명이 미인식되는 이유**  
   - OCR이 "군 자"를 **띄어쓰기로 분리**해 "군", "자" 두 블록으로 인식하는 경우가 많음.  
   - 기존 로직은 **역번호 뒤 첫 번째 한글 블록만** 사용하고, **2글자 이상**인 것만 역명 후보로 썼음.  
   - "군"(1글자), "자"(1글자)는 각각 2글자 미만이라 후보에서 제외 → 역명 후보 없음 → **역명 미인식**.

## 적용한 개선

1. **역번호 뒤 한글 블록 합치기** (`station-from-ocr.ts`)  
   - 역번호(예: 544) 뒤에 나오는 **모든 한글 블록을 이어 붙여** 역명 후보 생성.  
   - 예: "군", "자", "능동" → "군자능동".

2. **접두사로 화이트리스트 매칭** (`station-from-ocr.ts`)  
   - 합쳐진 문자열(최대 6글자)에 대해 **2·3·4글자 접두사**를 순서대로 화이트리스트와 비교.  
   - 예: "군자능동" → "군자"가 화이트리스트에 있으면 역명을 **군자**로 확정.

3. **능동 역명 추가** (`station-whitelist.ts`)  
   - "군자 (능동)" 표기 대비해 **능동**을 5호선 역명으로 추가(군자역 별칭).

## 결과

- "544 군 자 (능동)" 형태로 OCR되면: 역명 **군자**, 호선 **5호선**으로 인식.
- "544 능동"만 나와도: 역명 **능동**, 호선 **5호선**으로 인식.
