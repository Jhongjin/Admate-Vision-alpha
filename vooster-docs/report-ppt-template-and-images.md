# PPT 보고서: 촬영 사진 추가 및 템플릿 지원

## 1. 촬영한 사진 PPT 추가 (구현 완료)

- **동작**: 보고 발송 시 ZIP 첨부에 들어 있는 촬영 이미지(jpg/png 등)를 서버에서 추출해, PPT 노출량 보고서 **마지막 슬라이드들**에 “촬영 이미지 1”, “촬영 이미지 2” … 형태로 한 장씩 추가합니다.
- **조건**: “PPT 노출량 보고서 포함” 체크 + 역/호선 인식 + **ZIP 첨부가 있을 때** (다중 촬영으로 보고 발송한 경우) 촬영 사진이 PPT에 포함됩니다.
- **구현 위치**:
  - `src/features/capture/backend/report-exposure/zip-to-images.ts`: ZIP에서 이미지 파일만 추출해 base64 배열 반환
  - `src/features/capture/backend/route.ts`: 리포트 API에서 ZIP base64 → `extractImageBase64sFromZip` → `generateReportPpt({ imageBase64s })`
  - `src/features/capture/backend/report-exposure/ppt-generator.ts`: `imageBase64s`가 있으면 슬라이드 4~에 촬영 이미지 슬라이드 추가

---

## 2. PPT 템플릿 / 슬라이드별 이미지로 내용 채우기

요청: **사용자가 PPT 템플릿(또는 슬라이드 지면별 이미지)을 주면, 그 레이아웃에 맞춰 내용만 채워 넣을 수 있는지.**

### 2.1 슬라이드별 배경 이미지로 채우기 (구현 가능)

- **방식**: 사용자가 “표지용”, “요약용”, “시간대별용”, “촬영 이미지용” 등 **슬라이드 타입별 배경 이미지**를 제공(업로드 또는 URL). 서버는 해당 이미지를 **전체 슬라이드 배경**으로 넣고, 그 **위에** 텍스트·표를 오버레이해서 광고주명·역/호선·노출량·게재 기간 등을 채웁니다.
- **장점**: 현재 사용 중인 **pptxgenjs**만으로 구현 가능. 별도 .pptx 파싱/수정 라이브러리 불필요.
- **구현 시 고려 사항**:
  - 템플릿 이미지별 “텍스트/표가 들어갈 영역”을 좌표 또는 비율로 정의하거나, 고정 위치(x, y, w, h)에 텍스트/표를 넣는 방식.
  - 템플릿 이미지는 프로젝트에 정적 파일로 두거나, 설정(환경 변수/DB)으로 URL 또는 base64를 지정.

### 2.2 .pptx 템플릿 파일로 채우기 (별도 도구 필요)

- **방식**: 사용자가 **.pptx 템플릿 파일**을 업로드하면, 그 파일을 열어 특정 슬라이드/플레이스홀더에 광고주명·역·노출량·촬영 이미지 등을 채우는 방식.
- **현재 제약**: **pptxgenjs**는 **새 PPT 생성**만 지원하며, **기존 .pptx 파일을 열어서 수정**하는 API는 없습니다.
- **가능한 방안**:
  - **Node**: `officegen`, `pptx-parser` 등 기존 .pptx를 읽고 수정할 수 있는 라이브러리 조사·도입.
  - **Python 등 별도 서비스**: `python-pptx` 등으로 템플릿 .pptx를 로드한 뒤 플레이스홀더/텍스트 박스에 값 채우고, Node API에서 해당 서비스를 호출해 생성된 .pptx를 받는 방식.

---

## 3. 정리

| 항목 | 상태 | 비고 |
|------|------|------|
| 촬영한 사진 PPT에 추가 | ✅ 구현됨 | ZIP에서 이미지 추출 → PPT 슬라이드 4~에 추가 |
| 슬라이드별 배경 이미지 템플릿에 내용 채우기 | ⏳ 설계 가능 | pptxgenjs로 배경 이미지 + 오버레이 텍스트/표 |
| .pptx 템플릿 파일에 내용 채우기 | ❌ 미구현 | 다른 라이브러리 또는 별도 서비스 필요 |

템플릿을 “슬라이드별 배경 이미지”로 제공할 계획이면, 그에 맞춰 `ppt-generator`에 **템플릿 이미지 입력 + 영역별 데이터 매핑**을 추가하는 방식으로 확장할 수 있습니다.
